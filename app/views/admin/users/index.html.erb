<h2> View/Manage Users </h2>



<table>
  <tr>
    <th>
    <th>first
    <th>last
    <th>email
    <th>member?
    <th>expiration
    <th>admin?
  </tr>
<% @users.each do |user| %>
  <tr>
    <td><%= link_to '👤', "/users/#{user.id}" %>
    <td><%= user.first_name %>
    <td><%= user.last_name %>
    <td><%= user.email %>
    <%# approve pending user %>
    <td class="membership"><% if user.member? %>
          <span>✅</span>
        <% else %>
          <a class="approve-member-link" href="#">📝</a>
        <% end %>
    </td>
    <td><%= user.membership_expiration %>📝
    <td><%= 'yes' if user.is_admin? %>📝

<% end %>
</table>

<script>
  $('a.approve-member').on('click', function(){
    event.preventDefault();
    $.ajax({
        url: <%= url_for(controller: "roles", action: "member" ) %>,
        method: 'post',
      }).done(function(success){
        var marker = success ? '✅' : '‼️';
        $('td.membership').html(marker);
      });
  });

</script>


<%= form_for @roles, url: url_for(controller: "roles", action: "member") do |f| %>
        <%= hidden_field_tag "user_id", @user.id %>
        <%= f.submit "Approve Membership" %>
        <% end %>
