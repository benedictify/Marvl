<h2> View/Manage Users </h2>



<table>
  <tr>
    <th>
    <th>first
    <th>last
    <th>email
    <th>member?
    <th>expiration
    <th>admin?
  </tr>
<% @users.each do |user| %>
  <tr class="<%= user.id %>">
    <td><%= link_to '👤', "/users/#{user.id}" %>
    <td><%= user.first_name %>
    <td><%= user.last_name %>
    <td><%= user.email %>
    <%# approve pending user %>
    <td class="membership"><% if user.member? %>
          <span>✅</span>
        <% else %>
          <a class="approve-member" href="#">📝</a>
        <% end %>
    </td>
    <td><%= user.membership_expiration %>📝
    <td><%= 'yes' if user.is_admin? %>📝

<% end %>
</table>

<script>
  $('a.approve-member').on('click', function(){
    console.log('click')
    event.preventDefault();
    $.ajax({
        url: '<%= admin_user_roles_path(session[:user_id]) %>',
        method: 'post',
        data: { role_id: <%= @memberrole_id %> }
      }).done(function(user_id){
        var marker = '✅'
        console.log(user_id)
        $('tr.'+user_id+' td.membership').html(marker);
      });
  });

</script>


<%# form_for @roles, url: url_for(controller: "roles", action: "member") do |f| %>
        <%# hidden_field_tag "user_id", @user.id %>
        <%# f.submit "Approve Membership" %>
        <%# end %>
